services:
  # ============================================================
  #  3. COLAB SERVICES (Nube)
  # ============================================================
  
  # Nextcloud: Almacenamiento de archivos
  nextcloud:
    image: nextcloud:latest
    container_name: soteira_nextcloud
    depends_on:
      - nextcloud_db
    ports:
      - "80:80"
    volumes:
      - ./data/nextcloud:/var/www/html
    networks:
      - nextcloud_net

  # Base de datos para Nextcloud
  nextcloud_db:
    image: mariadb:10.6
    container_name: nextcloud_db
    environment:
      MYSQL_ROOT_PASSWORD: ${NEXTCLOUD_DB_PASSWORD}
      MYSQL_DATABASE: nextcloud
      MYSQL_USER: nextcloud
      MYSQL_PASSWORD: ${NEXTCLOUD_DB_PASSWORD}
    volumes:
      - ./data/nextcloud_db:/var/lib/mysql
    networks:
      - nextcloud_net

  # Red interna compartida para todos los servicios
networks:
  nextcloud_net:
    driver: bridge